# Ephemeral CSV Query AI ü§ñ

**Chat with your CSV data using Natural Language.**

This project is a lightweight, secure, and ephemeral AI agent that allows you to upload a CSV file and ask questions about your data in plain English. It leverages **DuckDB** for fast, in-memory SQL processing and **Large Language Models (LLMs)** to generate accurate SQL queries.

## üöÄ Features

- **Natural Language to SQL**: Converts your questions (e.g., "What are the top 5 sales regions?") into efficient SQL queries.
- **Privacy-First**:
    - **Ephemeral Database**: Data is loaded into an in-memory DuckDB instance. It exists only for the session duration.
    - **Read-Only**: The agent is strictly restricted to `SELECT` queries to prevent data modification.
    - **Secure Execution**: No data persists after the application stops.
- **Interactive UI**: Built with **Gradio** for a seamless upload-and-chat experience.
- **Schema-Aware**: The agent automatically inspects your CSV schema to understand column names and data types before querying.
- **Model Agnostic**: Compatible with any OpenAI-compatible API (via **OpenRouter**).

## üõ†Ô∏è Tech Stack

- **Language**: Python 3.12+
- **Database**: [DuckDB](https://duckdb.org/) (In-memory)
- **AI Framework**: [LangChain](https://www.langchain.com/)
- **UI Framework**: [Gradio](https://www.gradio.app/)
- **Package Manager**: `uv`

## üì¶ Installation

1. **Clone the repository**:
   ```bash
   git clone <your-repo-url>
   cd csv-query-ai
   ```

2. **Install dependencies**:
   Ensure you have `uv` installed (modern Python package manager).
   ```bash
   # Install dependencies and create virtual environment automatically
   uv sync
   ```

3. **Configure Environment**:
   Create a `.env` file in the root directory:
   ```ini
   OPENROUTER_API_KEY=your_api_key_here
   OPENROUTER_MODEL=openai/gpt-3.5-turbo  # or any other capable model
   OPENROUTER_API_URL=https://openrouter.ai/api/v1
   ```

## ‚ñ∂Ô∏è Usage

1. **Run the Application**:
   ```bash
   uv run main.py
   ```

2. **Open functionality**:
   - The app will launch at `http://127.0.0.1:7860`.
   - **Step 1**: Upload your CSV file.
   - **Step 2**: (Optional) Provide a brief description of the data to help the AI.
   - **Step 3**: Start chatting! Ask questions like:
     - *"Show me the first 5 rows."*
     - *"What is the average price by category?"*
     - *"Count the number of users who joined in 2023."*

## ‚öôÔ∏è Customization

- **Prompts**: Edit `prompts.yaml` to tweak the system prompt or enforcement rules.
- **Agent Logic**: Modify `agent.py` to change how the agent interacts with the database or to add new tools.

## üõ°Ô∏è Security Note

This tool executes SQL queries generated by an LLM. While we implement strict prompt engineering to enforce read-only access (LIMITs, no DDL/DML), always verify queries in critical environments.
